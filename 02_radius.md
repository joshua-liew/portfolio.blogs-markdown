# Aomori University's Eduroam Project & the RADIUS Server

*謝辞：ご指導いただいた 下條 真司 教授 に心から感謝いたしております。*

- [In English](#in-english)
- [In Japanese（日本語）](#in-japanese)

---

##### In Japanese

## ことの発端：チャンスが舞い降りた

> 壊れたものを見かけたら、それを直してみたら？チャンスなんだから。
>> ジョーダン・B・ピーターソン、
[2022年度ヒルズデール・カレッジの卒業式祝辞スピーチ](https://youtu.be/HvHjhtM8D7w?si=DmKTVYAVKvAiYeqm&t=2157)にて。

大学２年の頃（2023年5月）の話し。  
その年の前期にコンピュータ・ネットワークという講義を受けていた。
情報の基礎（例えば、クロード・シャノンの情報理論、など）から、
OSIモデルやTCP/IPプロトコルまで、コンピュータがどのように情報をやりとりしているか学ぶ時間だった。
その講義で使用していた教室および建物には無線LAN (Wi-Fi) 環境が全く整っていなかった（※ 地方大学あるある）。
当初からこの状況が多くの人にとって大学への不満の種であった。

ある日、講義の担当教員の下條先生が次のようなこと（記憶が定かではないが）をおしゃった。  
> 実は、これから青森大学の __無線LAN環境__ を色々と整備していく予定です。
まずは学生が使える無線LAN環境を整えるということで __eduroam__ を導入したいと思っています。
それで、__RADIUSサーバ__ の構築から始めます。誰か関わりたい人がいたら、手を挙げて言ってください。

その頃はまだ無知な自分だった（今もそうなのだが）ので、
「無線LAN環境（ん？）... eduroam（ん？）... RADIUSサーバ（ん？）」と思いながら聞いていた。
確かに分からないことが多く、そもそも経験がなかったのでどれぐらい難しいか知りようがなかった。

だが、これこそ何かのチャンスなのだ！と思わされ、「このさきに得られるもの（例えば、お金や誉れ）
はあるか」をいっさい考えずに、やります！と先生に言った。
結局、手を挙げたのは二人だけであり、私がその一人であった。  
__*こうして、私の大学生活を形作る経験が始まった。*__

## ロードマップ：Linux、RADIUS、eduroam

そもそも __eduroam__ とはどういうものだろうか？
eduroamを導入することが目標だったので、とりあえずそれを理解するところから。
簡単にいうと、eduroamはどこの学校や大学にいても、*学生として* 利用できるインターネットを実現する仕組みである。
当時、青森大学はeduroamに加入していなかったため、学内で使えるWi-Fi環境がなかったり、
青森大学の学生として他の大学に行ったら使えるWi-Fi環境が制限されたりしていた。
> eduroam は、初等・中等・高等教育機関や研究機関の間でキャンパス無線LANの相互利用を実現する、
国際的なネットワークローミング利用の仕組みです。
>> eduroam JP の概要（<https://www.eduroam.jp/about>）

eduroamは、RADIUSサーバの世界規模のツリーである。すなわちRADIUSサーバというものに構成され、
eduroamに加入している大学すべては、このRADIUSサーバを設置して運用している。
なので、それを理解した上で先生と相談したところ、ロードマップを設定した。
1. Linux：RADIUSサーバを構築するために、Linuxマシンを立ち上げる必要があった。
2. RADIUS：Linuxマシンの上に構築するRADIUSサーバとして、
FreeRADIUSというオープンソースソフトウェアを利用することにした。
3. ネットワーク機器：eduroamより提供されたWi-Fi環境は、
普段利用されるのと異なるWi-Fi技術によって支えられるため、
ネットワーク機器がその特定の技術を使用するように設定する必要があった。

#### Linux：つまずきと立ち上がりの繰り返し

それ以前、Linux系のOS の存在を知ったが、実際に触ったことが全くなかった。
WindowsマシンにLinux系のOSをインストールするところから始まったので、初心者の自分には思ったより難しい作業だった。
「OSイメージ？ブータブルUSB？」などを調べながらOSをインストールするところだけで苦労した。  
> ![Linux machine](/static/img/blogs/02_server.jpg)
> 写真１：使用していたLinuxマシン

インストールに無事成功した！と思ったら、黒い背景に文字が羅列された画面、つまりCLIというものに初めて出会った。
「操作がわからないが？インターネットにつながらない？SSH？ファイアウォール？...」などでCLIとの戦いでまた苦労した。  
ある程度操作できるようになるのに __3/4週間ぐらい__ かかり、その間数え切れないほどOSやマシンを壊してしまい、
OSのインストールから何度もやり直した。関わってから __１か月ぐらいの苦労の末__ 、
LinuxマシンをCLIで操作するのに慣れて次のステップにやっと進むことができた。
> ![CLI](/static/img/blogs/02_linux.jpg)
> 写真２：何かをインストールしようとしたときの画面

#### RADIUS：公式ドキュメントを読むことの重要性

> *Read The F\*cking Manual (RTFM) | マニュアルを読みやがれ*  
> This acronym is often used when someone asks a simple or common question.  
> 訳：このRTFMとは、誰かが簡単な質問や、ありふれた質問をした際にしばしば使われる。
>> RFC 1983: [Internet Users' Glossary](https://datatracker.ietf.org/doc/html/rfc1983) |
>> [インターネットユーザの用語集](https://jbpe.tripod.com/rfcj/rfc1983.j.sjis.txt)

技術者のインターネットスラングの一つとして、[RTFM](https://ja.wikipedia.org/wiki/RTFM)という表現がよく使われる。
そして、FreeRADIUSを用いたRADIUSサーバを立ち上げる過程において、このことの重要性を実感した。

最初は、分からないことだらけだったため、"分かりやすい"ブログ記事や設定手順ガイドなどを頼りに、
サーバ構築を進めていた。それだけでかなりいいところまで持っていけたのだが、
「設定手順に沿ってやったのにエラーが出た」という思いもよらない場合には対処できなかった。
一時的にChatGPTのようなLLMの力を借りることで対処できたが、やがてやることが複雑になったりデバッグを必要とするにつれて、
再び対処しようがない状況に陥ったりしていた。  

__むろん、私に欠けていたのは、システム（この場合だと、FreeRADIUS）の理解であった。
事実、技術者としてのコンピテンシーがまだなかったのだ。__

それに気付いた自分は、一歩下がって「このシステムをもっとも速く理解する方法はなんだろう」と考えてみた。
そこで、[CS50](https://pll.harvard.edu/course/cs50-introduction-computer-science)
というオンライン・コンピュータ・サイエンス入門講座で学んだことを一つ思い出し、それは、
__*公式ドキュメントを読むこと以外に近道はない、*__ ということだった。
こうして、FreeRADIUS の [公式ドキュメント](https://networkradius.com/doc/current/index.html)
と [ソースコード](https://github.com/FreeRADIUS/freeradius-server)、
そしてRADIUSプロトコルに関する [RFC 2865](https://datatracker.ietf.org/doc/html/rfc2865) を開いて読み始めた。
すべてを読み終わるのに１か月ぐらいかかり、何回も読み返して*概ね*
理解するのにまた２か月ぐらいかかった（※ いまだに理解できていない部分は残っている）。

時間はかかったものの、そのおかげで自力でデバッグしたり独自モジュールを作成したりすることができるようになった。

> ![Documentation & Notes](/static/img/blogs/02_document.jpg)
> 写真３：理解のために印刷したドキュメントと手書きノート

#### eduroam：最後まで目標を忘れずにやりきる志

2024年1月18日の14時ごろ、必要な手続きを経てeduroam開通を確認できた。  
これは先生が海外出張でどこかの学術研究機関に行ったときの話しだが、突然先生から次の連絡をいただいた。
```
18/01/2024 1:59 pm：ごめん、私のeduroamのアカウント、パスワード教えて。
```

アカウントとパスワードをお伝えして数分待っていたら...
```
18/01/2024 2:12 pm：認証サーバーが応答しないとのこと  
（解釈：うまくいかなかった）
```

なるほど？と思い、設定を見直したら設定ミスを発見した。やりとりを続けながら、設定を直してみたら...
```
18/01/2024 2:24 pm：繋がった  
18/01/2024 2:24 pm：おめでとうございます。
```
> ![Successful eduroam implementation](/static/img/blogs/02_eduroam.png)
> 写真４：eduroam開通を確認したときにとったスクリーンショット

その瞬間に味わった達成感と言ったら！ __７/８か月ぐらいの努力がついに実を結んだのだ！__  
確かに、粘り強く最後までやり遂げたことにしか得られない喜びがあるのだ、と思った。
しかし、それよりも、*それまでの過程にさらなる喜びや価値があったことに気付いた*。  
それまでの失敗や大変なことに意味があった、と。  
それまでの努力や犠牲に意味があった、と。  
それまでの歩みが本当に良かった、と。

## 最後に：チャンスが次から次へと舞い込む

冒頭にも書いたのだが、このRADIUSサーバ構築の経験が私の大学生活を形作るものであった。
なぜなら、指導していただいた先生がこのことを見てくださったら、また別のサーバーを立ち上げることを頼んでくださったからだ。
それだけでなく、様々な研究会でそれらの関係でやってきた技術的なことを発表する機会も与えたくださったからなのだ。
さらに、大学のネットワークを全面的に再構築するプロジェクトに関わらせていただいたなのである。
こうして、大学生活が意味づけられ、楽しいものとなった。

最初のチャンスを逃してしまったら、どうなったのだろう。
そのチャンスを与えてくださった下條先生がいてくださらなかったら、どうなったのだろう。
そういうことは私には分からないからこそ、 __与えられたことや与えてくださる方々に深く感謝しています。__

> 壊れたものを見かけたら、それを直してみたら？チャンスなんだから。
> 直せたら、それを直した人になるんだ。そうしてやることが本当にあるんだ。
> そうなると、人に認められて「あれもこれも直してもらえないか？」と声をかけられたりして。
> こうして、一つずつ直していくことによって人生の可能性が広がっていくのよ。
>> ジョーダン・B・ピーターソン、
[2022年度ヒルズデール・カレッジの卒業式祝辞スピーチ](https://youtu.be/HvHjhtM8D7w?si=DmKTVYAVKvAiYeqm&t=2157)にて。
